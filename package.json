{
  "name": "plc-emu",
  "displayName": "PLC Emulator Prototype",
  "publisher": "spirithere",
  "version": "0.1.0",
  "description": "Prototype VS Code extension that edits PLCopen XML projects, provides ladder/ST tooling, and runs a simple PLC emulator.",
  "license": "MIT",
  "engines": {
    "vscode": "^1.89.0"
  },
  "categories": [
    "Other"
  ],
  "main": "./out/extension.js",
  "activationEvents": [
    "onCommand:plcEmu.openProject",
    "onCommand:plcEmu.openStructuredText",
    "onCommand:plcEmu.openStructuredTextBlock",
    "onCommand:plcEmu.openLadderEditor",
    "onCommand:plcEmu.openIOSimulator",
    "onCommand:plcEmu.openIOMapping",
    "onCommand:plcEmu.editProjectInfo",
    "onView:plcProjectEditor",
    "onCommand:plcEmu.switchProfile",
    "onCommand:plcEmu.run",
    "onCommand:plcEmu.stop",
    "onView:plcPouExplorer",
    "onView:plcRuntimeControls",
    "onView:plcHmiView",
    "onCommand:plcEmu.openHmiDesigner",
    "onCommand:plcEmu.openHmiRuntime"
  ],
  "contributes": {
    "commands": [
      {
        "command": "plcEmu.openProject",
        "title": "PLC Emulator: Open PLCopen Project",
        "icon": "$(folder-opened)"
      },
      {
        "command": "plcEmu.openStructuredText",
        "title": "PLC Emulator: Edit Structured Text Block",
        "icon": "$(file-code)"
      },
      {
        "command": "plcEmu.openStructuredTextBlock",
        "title": "PLC Emulator: Open Structured Text Block"
      },
      {
        "command": "plcEmu.openLadderEditor",
        "title": "PLC Emulator: Open Ladder Editor",
        "icon": "$(list-tree)"
      },
      {
        "command": "plcEmu.openIOSimulator",
        "title": "PLC Emulator: Open I/O Simulator",
        "icon": "$(circuit-board)"
      },
      {
        "command": "plcEmu.openIOMapping",
        "title": "PLC Emulator: Open I/O Mapping",
        "icon": "$(plug)"
      },
      {
        "command": "plcEmu.editProjectInfo",
        "title": "PLC Emulator: Edit Project Info",
        "icon": "$(gear)"
      },
      {
        "command": "plcEmu.switchProfile",
        "title": "PLC Emulator: Switch Dialect Profile",
        "icon": "$(gear)"
      },
      {
        "command": "plcEmu.run",
        "title": "PLC Emulator: Run Program",
        "icon": "$(play)"
      },
      {
        "command": "plcEmu.stop",
        "title": "PLC Emulator: Stop Program",
        "icon": "$(stop)"
      },
      {
        "command": "plcEmu.openHmiDesigner",
        "title": "PLC Emulator: Open HMI Designer",
        "icon": "$(layout)",
        "category": "PLC Emulator"
      },
      {
        "command": "plcEmu.openHmiRuntime",
        "title": "PLC Emulator: Open HMI Runtime",
        "icon": "$(screen-full)",
        "category": "PLC Emulator"
      }
    ],
    "viewsContainers": {
      "activitybar": [
        {
          "id": "plcEmuSidebar",
          "title": "PLC Emulator",
          "icon": "./media/icons/plc.svg"
        }
      ]
    },
    "views": {
      "plcEmuSidebar": [
        {
          "id": "plcPouExplorer",
          "name": "POUs"
        },
        {
          "id": "plcRuntimeControls",
          "name": "Runtime",
          "type": "webview"
        },
        {
          "id": "plcHmiView",
          "name": "HMI",
          "type": "webview"
        },
        {
          "id": "plcProjectEditor",
          "name": "Project",
          "type": "webview"
        }
      ]
    },
    "jsonValidation": [
      {
        "fileMatch": [
          ".plc/hmi.json",
          "**/hmi.json"
        ],
        "url": "./schemas/hmi.schema.json"
      }
    ],
    "menus": {
      "view/title": [
        {
          "command": "plcEmu.run",
          "when": "view == plcPouExplorer && !plcEmu.running",
          "group": "navigation@1"
        },
        {
          "command": "plcEmu.stop",
          "when": "view == plcPouExplorer && plcEmu.running",
          "group": "navigation@1"
        },
        {
          "command": "plcEmu.openProject",
          "when": "view == plcPouExplorer",
          "group": "navigation@2"
        },
        {
          "command": "plcEmu.openStructuredText",
          "when": "view == plcPouExplorer",
          "group": "navigation@3"
        },
        {
          "command": "plcEmu.openLadderEditor",
          "when": "view == plcPouExplorer",
          "group": "navigation@4"
        },
        {
          "command": "plcEmu.openIOSimulator",
          "when": "view == plcPouExplorer",
          "group": "navigation@5"
        },
        {
          "command": "plcEmu.switchProfile",
          "when": "view == plcPouExplorer",
          "group": "navigation@6"
        },
        {
          "command": "plcEmu.openIOMapping",
          "when": "view == plcPouExplorer",
          "group": "navigation@6"
        },
        {
          "command": "plcEmu.editProjectInfo",
          "when": "view == plcPouExplorer",
          "group": "navigation@9"
        },
        {
          "command": "plcEmu.openHmiDesigner",
          "when": "view == plcPouExplorer",
          "group": "navigation@7"
        },
        {
          "command": "plcEmu.openHmiRuntime",
          "when": "view == plcPouExplorer",
          "group": "navigation@8"
        },
        {
          "command": "plcEmu.run",
          "when": "view == plcRuntimeControls && !plcEmu.running",
          "group": "navigation@1"
        },
        {
          "command": "plcEmu.stop",
          "when": "view == plcRuntimeControls && plcEmu.running",
          "group": "navigation@1"
        },
        {
          "command": "plcEmu.openProject",
          "when": "view == plcRuntimeControls",
          "group": "navigation@2"
        },
        {
          "command": "plcEmu.openStructuredText",
          "when": "view == plcRuntimeControls",
          "group": "navigation@3"
        },
        {
          "command": "plcEmu.openLadderEditor",
          "when": "view == plcRuntimeControls",
          "group": "navigation@4"
        },
        {
          "command": "plcEmu.openIOSimulator",
          "when": "view == plcRuntimeControls",
          "group": "navigation@5"
        },
        {
          "command": "plcEmu.switchProfile",
          "when": "view == plcRuntimeControls",
          "group": "navigation@6"
        },
        {
          "command": "plcEmu.openIOMapping",
          "when": "view == plcRuntimeControls",
          "group": "navigation@6"
        },
        {
          "command": "plcEmu.editProjectInfo",
          "when": "view == plcRuntimeControls",
          "group": "navigation@9"
        },
        {
          "command": "plcEmu.openHmiDesigner",
          "when": "view == plcRuntimeControls",
          "group": "navigation@7"
        },
        {
          "command": "plcEmu.openHmiRuntime",
          "when": "view == plcRuntimeControls",
          "group": "navigation@8"
        },
        {
          "command": "plcEmu.editProjectInfo",
          "when": "view == plcProjectEditor",
          "group": "navigation@1"
        }
      ]
    },
    "configuration": {
      "title": "PLC Emulator",
      "properties": {
        "plcEmu.projectFile": {
          "type": "string",
          "default": "project.plcopen.xml",
          "description": "Relative path to the PLCopen XML file that acts as the project source of truth."
        },
        "plcEmu.scanTimeMs": {
          "type": "number",
          "default": 100,
          "minimum": 10,
          "description": "Default scan cycle time in milliseconds for the emulator."
        },
        "plcEmu.profileId": {
          "type": "string",
          "default": "iec61131",
          "enum": [
            "iec61131",
            "vendorA",
            "vendorB"
          ],
          "description": "Dialect profile that controls vendor-specific behavior (prototype)."
        },
        "plcEmu.runtimeMode": {
          "type": "string",
          "default": "embedded",
          "enum": [
            "embedded",
            "external"
          ],
          "description": "Choose between the in-process emulator and the external runtime host service."
        },
        "plcEmu.hmiFile": {
          "type": "string",
          "default": ".plc/hmi.json",
          "description": "Relative path to the HMI JSON file that defines widgets, layout and bindings."
        }
      }
    },
    "languages": [
      {
        "id": "st",
        "aliases": [
          "Structured Text",
          "ST"
        ],
        "extensions": [
          ".st"
        ],
        "configuration": "./language-configuration.json"
      }
    ],
    "grammars": [
      {
        "language": "st",
        "scopeName": "source.st",
        "path": "./syntaxes/st.tmLanguage.json"
      }
    ],
    "snippets": [
      {
        "language": "st",
        "path": "./snippets/st.json"
      }
    ]
  },
  "scripts": {
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "verify": "npm run compile && npm test",
    "vscode:prepublish": "npm run compile",
    "package": "npm run compile && npx @vscode/vsce package",
    "test": "vitest run",
    "host": "npm run compile && node ./out/runtime/host/cli.js",
    "host:all": "npm run compile && node ./out/runtime/host/cli.js --mcp-port=8124",
    "host:mcp": "npm run compile && node ./out/runtime/mcp/cli.js",
    "plcrun": "node ./out/runtime/host/client.js"
  },
  "devDependencies": {
    "@types/node": "^20.12.12",
    "@types/vscode": "^1.89.0",
    "@vscode/test-electron": "^2.5.2",
    "typescript": "^5.5.4",
    "vitest": "^1.6.1"
  },
  "dependencies": {
    "chevrotain": "^10.5.0",
    "fast-xml-parser": "^5.3.1",
    "fastmcp": "^3.33.0",
    "zod": "^4.3.6"
  }
}
